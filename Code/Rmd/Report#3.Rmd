---
title: 'Report #3'
author: "GROUP 9"
classoption: 12pt
output: bookdown::pdf_document2
bibliography: ../../Reference/bib/References.bib
link-citations: true
biblio_style: "apalike"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(ggplot2)
require(ggcorrplot)
require(ggthemes)
require(matlib)
require(bookdown)
require(xtable)
require(moments)
require(gridExtra)
```

# EDA

## Read Data

The dataset have 395 records in total with 5 numerical variables and 28 categorical variables. The numerical variables include age, number of school absences, 1st Period grade, 2nd period grade and final period grade. The categorical variables include sex, address(urban/rural), parents highest qualification, family size, commuting time, study time and so on. The table below shows the first 5 records with 10 variables.

```{r, echo=FALSE}
student=read.table("../../Data/CSV/student-mat.csv",sep=";",header=TRUE)
```

\begin{table}[ht]
\centering
\begin{tabular}{rllrlllrrll}
  \hline
 & school & sex & age & address & famsize & Pstatus & Medu & Fedu & Mjob & Fjob \\ 
  \hline
1 & GP & F &  18 & U & GT3 & A &   4 &   4 & at\_home & teacher \\ 
  2 & GP & F &  17 & U & GT3 & T &   1 &   1 & at\_home & other \\ 
  3 & GP & F &  15 & U & LE3 & T &   1 &   1 & at\_home & other \\ 
  4 & GP & F &  15 & U & GT3 & T &   4 &   2 & health & services \\ 
  5 & GP & F &  16 & U & GT3 & T &   3 &   3 & other & other \\ 
  6 & GP & M &  16 & U & LE3 & T &   4 &   3 & services & other \\ 
   \hline
\end{tabular}
\end{table}



## Summary Table

### Categorical Summary

Three categorical variables:\
School - student's school ('GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)\
Sex - student's sex ('F' - female or 'M' - male)\
Failures - number of past class failures (n if 1<=n<3, else 4)\

The table \@ref(tab:summary) and Figure&nbsp;\@ref(fig:ct) show the count of each categorical variables. There are more students from Gabriel Pereira school than Mousinho da Silveira school. There are slightly higher number of female students compared to male students. Most of the students never failed the other courses before.

```{r CateSum, echo=FALSE}
student$school <- as.factor(student$school)
student$sex <- as.factor(student$sex)
student$failures <- as.factor(student$failures)
df = data.frame(student$school,student$sex,student$failures)
names(df) = c("School", "Sex", "Failures")
#xtable(summary(df))
```

\begin{table}[ht]
\centering
\caption {Summary of Three Categorical Variables}
\begin{tabular}{lll}
  \hline
 School & Sex & Failures \\ 
  \hline
GP:349   & F:208   & 0:312   \\ 
MS: 46   & M:187   & 1: 50   \\ 
  &  & 2: 17   \\ 
  &  & 3: 16   \\ 
   \hline
\end{tabular} (\#tab:summary)
\end{table}


```{r ct, fig.height=4, fig.cap="Barplot for Categorical Variables", fig.pos="center", echo=FALSE, warning=FALSE}
lapply(names(df), function(col) {
  ggplot(df, aes(.data[[col]], ..count..)) + 
    geom_bar(aes(fill = .data[[col]]), position = "dodge")
}) -> lp
grid.arrange(lp[[1]], lp[[2]], lp[[3]], ncol = 3)
```




### Numerical Summary
Five numerical Variables:\
Age - student's age (from 15 to 22)\
Absences - number of school absences (from 0 to 93)\
G1 - first period grade (from 0 to 20)\
G2 - second period grade (from 0 to 20)\
G3 - final grade (from 0 to 20, output target)\

Means: \
```{r NumSum, echo=FALSE}
df_num = data.frame(student$age, student$absences, 
                    student$G1, student$G2, student$G3)
names(df_num) <- c("age", "absences", "G1","G2","G3")
colMeans(df_num)
```

Covariance matrix:\
```{r covmat,echo=FALSE}
cov(df_num)
```

Correlation Matrix:\
```{r cormat,echo=FALSE}
cor(df_num)
```

Skewness and kurtosis:\
```{r skekur,echo=FALSE}
skewness(df_num)
kurtosis(df_num)
```

## Correlation Plot

```{r corplot,echo=FALSE}
ggcorrplot(cor(df_num),
method = "circle",
hc.order = TRUE,
type = "lower")
```


## Box Plot

The Figure&nbsp;\@ref(fig:box) shows the box plots of final grade, number of absences and age grouped by the three categorical variables (School, Sex and Failures). The box plots show that the final grade does not differ much among school or sex but it differs by the number of past failures. Even though there are variations, those with fewer number of failures tend to have higher final grades. All box plot for the number of absences shows that they are heavily skewed to large number. The box plot for age shows that Mousinho da Silveira school have higher median age compared to Gabriel Pereira school.



```{r box, fig.height=6, fig.cap="Boxplot of Final grade against 3 categorical variables", echo=FALSE, warning=FALSE, message=FALSE}
lp <- list()
df_all <- cbind(df, df_num)
for (i in 1:length(names(df))){
   lp[[i]] <- ggplot(df_all, aes_string(x=names(df)[i], y="G3", col = names(df)[[i]])) + 
    geom_boxplot(notch=TRUE) +
     labs(y="Final Grade")
}

lp2 <- list()
for (i in 1:length(names(df))){
   lp2[[i]] <- ggplot(df_all, aes_string(x=names(df)[i], y="absences", col = names(df)[[i]])) + 
    geom_boxplot(notch=TRUE) +
     labs(y="Number of Absences")
}

lp3 <- list()
for (i in 1:length(names(df))){
   lp3[[i]] <- ggplot(df_all, aes_string(x=names(df)[i], y="age", col = names(df)[[i]])) + 
    geom_boxplot(notch=TRUE) +
     labs(y="Age")
}


grid.arrange(lp[[1]], lp[[2]], lp[[3]],
             lp2[[1]], lp2[[2]], lp2[[3]],
             lp3[[1]], lp3[[2]], lp3[[3]],ncol = 3)
```

\
\
\
\
\


# References 
